{ pkgs ? (import <nixpkgs> {})
, compiler ? pkgs.haskell.packages.ghc802
, ghc ? pkgs.haskell.compiler.ghc802
}:

with (import <nixpkgs/pkgs/development/haskell-modules/lib.nix> { inherit pkgs; });

let
  hackagePackages = import <nixpkgs/pkgs/development/haskell-modules/hackage-packages.nix>;
  stackPackages = import ./initialPackages.nix;
in
compiler.override {
  initialPackages = (args: self: (hackagePackages args self) // (stackPackages args self));
}
